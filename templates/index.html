{%extends "base.html"%}{% block content%}
{% if Status==True %}
{% block head %}{% endblock%}
{%block footer %}{% endblock %}
<input type="hidden" value="{{Name}}" id="Name">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.8/socket.io.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>

<script type="text/javascript">
	$(document).ready(function () {
				let currentUser;
				var socket = io.connect("127.0.0.1");
				var socket_messages = io.connect("127.0.0.1:5000/message")
				$('#sendbutton').on('click', function (data) {
					var message = $('#myMessage').val();
					currentUser = $('#Name').val();

					socket_messages.emit('message from user', {
						messages: message,
						names: currentUser
					});

				});
				socket_messages.on('from flask', function (data) {




							var textToAppend = `<li id = "usermessage" ${currentUser == data['names'] ? 'style="background-color:blue" >' : '>' } ${data['names']} : ${data['messages']}`

			
		
		$('#messages').append(textToAppend)
		



	});
})
</script>
<ul id="messages"></ul>
<input type="text" id="myMessage">
<button id="sendbutton">Send</button>
{%else%}
<p>Please <a href="/login">login</a> or <a href="/register">register</a></p>
{% endif %}
{% endblock %}